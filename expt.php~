<?php

include_once "Table.class.php";
include_once "new-functions.php";

function showForm($action, $form_array)	{
	$form = "<form method='post' action=".$action.">";
	foreach($form_array as $key => $value) {
		$form .= "<p><label>".$form_array[$key]['form_label'].": <input name='".$key."' type='".$form_array[$key]['type']."' value='".$form_array[$key]['value']."'></label></p>";
	}
	$form .= "<input type='submit'> <a href='index.php'> Cancel </a></form></br>";
	return $form;
}

$action = 'expt.php';

$snippet_form_array = array ( 
			"snippet" => array (
						"name" => "snippet",
						"value" => "",
						"error_mssg" => "",
						"form_label" => "Snippet",
						"type" => "text",
						"validate" => "string"
						),
			"description" => array (
						"name" => "description",
						"value" => "",
						"error_mssg" => "",
						"form_label" => "Describe",
						"type" => "text",
						"validate" => "string"
						),
			"language" => array 	(
						"name" => "language",
						"value" => "",
						"error_mssg" => "",
						"form_label" => "Language",
						"type" => "text",
						"validate" => "string"
						)
);

If ($_SERVER['REQUEST_METHOD'] == 'POST')	{
	$snippet_form_array = assignPostToFormArray($snippet_form_array);
	$snippet_form_array = validateFormArray($snippet_form_array);
	$is_form_valid = isFormValid($snippet_form_array);

	
	if($is_form_valid === true AND !isset($_GET['id'])) {
		//$table->save('snip', $snippet_form_array); // saves post as a new row
	}

	if($is_form_valid === true AND isset($_GET['id'])) {
		$table->updateRow('snip', $snippet_form_array, $id);  // updates a row from an edited post
	}
}

$snippet_form = showForm($action, $snippet_form_array);

echo '<html><head></head><body>';
echo $snippet_form;
echo '</body></html>';
echo '<pre>';
var_dump($snippet_form_array);
echo '</pre>';
echo '<pre>';
var_dump($is_form_valid);
echo '</pre>';

