<?php

include_once 'functions.php';
//include_once 'database-functions.php';
$host = '127.0.0.1';
$db   = 'testing_pdo';
$charset = 'utf8mb4';
$dsn = "mysql:host=$host;dbname=$db;charset=$charset";
$user = 'root';
$pass = '';
$opt = [
    PDO::ATTR_ERRMODE            => PDO::ERRMODE_EXCEPTION,
    PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,
    PDO::ATTR_EMULATE_PREPARES   => false,
];
$pdo = new PDO($dsn, $user, $pass, $opt);

/*
$snippet_form_array = array ( 
			"snippet" => array (
						"name" => "snippet",
						"required" => "required",
						"value" => "",
						"error_mssg" => "",
						"form_label" => "Snippet",
						"type" => "text",
						"validate" => "unique"
						),
			"description" => array (
						"name" => "description",
						"required" => "",
						"value" => "",
						"error_mssg" => "",
						"form_label" => "Describe",
						"type" => "text",
						"validate" => "string"
						),
			"importance" => array (
						"name" => "importance",
						"required" => "",
						"value" => "",
						"error_mssg" => "",
						"form_label" => "Importance",
						"type" => "text",
						"validate" => "string"
						),
			"language" => array 	(
						"name" => "language",
						"required" => "",
						"value" => "",
						"error_mssg" => "",
						"form_label" => "Language",
						"type" => "select",
						"options" => array (
										"" => "",
										"php" => "PHP",
										"sql" => "SQL",
										"bash" => "Bash"
										),
						"validate" => ""
						)
);
*/

$example_form_array = array ( 
			"first_name" => array (
						"name" => "first_name",
						"value" => "Maria"
						),
			"last_name" => array (
						"name" => "last_name",
						"value" => "DAngelo"
						)
);

function save($table_name, $form_array, $pdo) {
		/*
		$fields = "";
		$values = "'";
		foreach($form_array as $key => $array) {
			$fields .= $key.", ";
			$values .= $array['value']."', '";
		}
		*/
		
		$fields = "";
		//$values = "";
		foreach($form_array as $key => $array) {
			$fields .= $key.", ";
			$values[] = $array['value'];
		}
		
		//get rid of the trailing comma and space
		$fields = substr($fields, 0, -2);
		$values = substr($values, 0, -3);
		
		//the question mark place holders should be generated so the right number is produced for the table in question
		$sql = "INSERT INTO $table_name ($fields) VALUES (?, ?)";
		
		$statement = $pdo->prepare($sql);
		$statement->execute($values);
		return $statement;
		return $values;
	}
	
function getAll($table_name, $pdo)
{
	$sql = "SELECT * FROM $table_name";
	$statement = $pdo->query($sql);
	return $statement;
}
	
	
	$statement = save('person_2', $example_form_array, $pdo);
	
	//var_dump($values);
	
	var_dump($statement);
	
	$statement_1 = getAll('person_2', $pdo);
	$table = createTable($statement_1);

echo '<!DOCTYPE html><html><head><meta charset="utf-8" /><title></title></head>';
echo $table;
echo '</br>';
echo '<body></body></html>';
	
	
	